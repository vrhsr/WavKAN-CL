\documentclass[pdflatex,sn-mathphys-num]{sn-jnl} 

\usepackage{graphicx}
\usepackage{multirow}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage[title]{appendix}
\usepackage{xcolor}
\usepackage{textcomp}
\usepackage{manyfoot}
\usepackage{booktabs}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{listings}
% \usepackage[none]{hyphenat} % Uncomment this line to disable hyphenation (useful for copy-pasting to AI detectors)

\theoremstyle{thmstyleone}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{thmstyletwo}
\newtheorem{example}{Example}
\newtheorem{remark}{Remark}
\theoremstyle{thmstylethree}
\newtheorem{definition}{Definition}

\raggedbottom

\begin{document}

\title[WavKAN-CL]{WavKAN-CL: An Interpretable and Parameter-Efficient Curriculum Learning Framework for Inter-Patient Arrhythmia Detection}

\author*[1]{\fnm{Venkate Ramanan} \sur{Manivannan}}\email{venkate.ramanan2024@vitstudent.ac.in} 
\author[1]{\fnm{Ramanathan} \sur{Lakshmanan}}\email{ramanathan.l@vit.ac.in}

\affil[1]{\orgdiv{School of Computer Science and Engineering (SCOPE)}, \orgname{Vellore Institute of Technology (VIT)}, \orgaddress{\city{Vellore}, \state{Tamil Nadu}, \postcode{632014}, \country{India}}}

%% ABSTRACT
\abstract{
This paper introduces WavKAN-CL, a structurally interpretable learning framework that integrates Wavelet Kolmogorov-Arnold Networks (WavKAN) with a minority-prioritized curriculum learning strategy for arrhythmia classification.

Traditional CNNs employ non-adaptive activation functions. WavKAN does things differently. Instead of static nodes, it embeds learnable wavelet bases directly on network edges. This unique structure enables explicit modeling of high-frequency morphological details, which are then combined with rhythm dynamics derived from the past sequence of RR intervals.

To overcome the huge class imbalance usually present in the MIT-BIH Arrhythmia Database, our approach follows a curriculum learning strategy, which is based on giving more attention to minority classes in the early stages of training.

Under the challenging Inter-Patient evaluation protocol (DS1/DS2), the proposed model achieves a mean ventricular-class (V) recall of 0.87 (Peak recall 0.90), emphasizing clinical safety in the detection of life-threatening arrhythmias.

Although minority-class detection remains challenging under strict inter-patient partitioning, WavKAN-CL requires only 95,189 parameters, corresponding to a $>$95\% reduction compared to state-of-the-art Transformer-based methods (e.g., ECGformer).

We swapped out traditional black-box MLPs for interpretable and learnable KAN layers. This makes the model efficient enough for a wearable but also allows its decisions to be easy to traceâ€”aligning perfectly with Green AI goals of being both clear and efficient.
}

\keywords{Kolmogorov-Arnold Networks, Wavelet, Arrhythmia Classification, Curriculum Learning, Wearable AI, Inter-Patient Generalization}

\maketitle

%% 1. INTRODUCTION
\section{Introduction}

Cardiovascular diseases (CVDs) are the leading cause of deaths worldwide, and they require efficient and uninterrupted solutions for cardiac monitoring. 

While the Electrocardiogram (ECG) is the diagnostic gold standard for diagnosing arrhythmias, manual interpretation of long-term Holter recordings is labor intensive, prone to error and infeasible for large-scale screening.

In order to automate this process, deep learning architectures, specifically Convolutional Neural Networks (CNNs) \cite{takalo-mattila_inter-patient_2018, guo_inter-patient_2018} and Transformers \cite{akan_ecgformer_2024}, have been widely used and attained favorable results under standardized experimental conditions. However, despite these advances in accuracy there are three major hurdles that current state-of-the-art solutions face in being safely deployed in practice:

\begin{enumerate}
    \item \textbf{Opacity of Black-Box Models:} The limited transparency of CNN and Transformer-based architectures limits the ability to connect these learned features back to physiologic markers, such as the shape of the P-wave originated from cardiac muscle contraction. Because of this lack of transparency, reduces clinician confidence, which creates barriers for regulation \cite{taleban_explainable_2026}.
    \item \textbf{Inter-Patient Generalization Gap:} A problem encountered in previous studies is an overreliance on intra-patient assessments. Intra-patient assessments are when the heartbeats from one patient are split into a training and test set. This method generates inflated performance metrics for studies, as the analysis overfits to the individual patient's features \cite{bahrami_investigation_2025}. Recent systematic reviews suggest that models trained on unseen patients (the strict inter-patient evaluation paradigm) experience significant performance decline, and often are unable to detect minority arrhythmia classes \cite{silva_systematic_2025, xiao_deep_2023}.
    \item \textbf{Computational Inefficiency:} Modern architectures such as Vision Transformers (ViT) need millions of parameters, which makes them unsuitable for battery-limited wearable devices, where energy efficiency is of the utmost importance \cite{elsheikhy_lightweight_2025}. 
\end{enumerate}

Recently, Kolmogorov-Arnold Networks (KANs) \cite{liu_kan_2025} have become a promising alternative to Multi-Layer Perceptrons (MLPs). Unlike MLPs where fixed activation functions are used on nodes, KANs use learnable activation functions on edges. Theoretically this structure provides improved parameter efficiency and structural transparency. Although some of the initial adjustments of KANs for ECGs have seen positive results (for example MAK-Net \cite{zhao_mak-net_2025}), the use of B-spline bases is generally recommended. B-splines, on the other hand may have a hard time to efficiently capture the fast transient features of physiological signals without overfitting to noise \cite{bozorgasl_liu_2024}. In addition, the stringent requirements of "Green AI" require models not only to be accurate, but also to be lean enough for edge deployment \cite{farag_tiny_2023}.

This paper proposes WavKAN-CL, a structurally motivated adaptation of the KAN architecture for modeling complex ECG waveforms. We substitute the standard B-splines with learnable Mexican Hat Wavelets which naturally exhibit the spectral properties of the QRS complex \cite{addison_wavelet_2005}. To overcome the issue of severe class imbalance present in inter-patient datasets \cite{silva_systematic_2025, bae_handling_2025}, we combine a strategy known as Curriculum Learning \cite{schmale_curriculum_2025}, that ensures the exposure of minority classes (S and F beats) in early training stages.

The contributions of this study include:

\begin{enumerate}
    \item \textbf{A structurally transparent architecture:} WavKAN substitutes traditional MLP layers with learnable Mexican Hat wavelets to enhance structural interpretability. This brings the feature extraction being performed inside the network to the same point as the physiological morphology of the QRS complex, addressing the black-box opacity barrier.
    \item \textbf{Robust Inter-Patient Generalization:} We propose a minority-prioritized Curriculum Learning strategy that prevents the overfitting of majority-classes. This stabilizes the generalization gap under the strict inter-patient protocol (DS1/DS2) improving reliability on unseen patients.
    \item \textbf{Green AI Efficiency:} To optimize energy use while maintaining clinical accuracy using fewer than 100k parameters, WavKAN-CL utilizes wavelet edges instead of traditional parameter-heavy Transformer blocks. This enables deployment in wearable devices using WavKAN-CL to be viable in battery-constrained environments.
\end{enumerate}

%% 2. METHODOLOGY
\section{Methodology}
\label{sec:methods}

\subsection{Problem Formalization}
Given an ECG signal segmented into beat centered windows $x_i \in \mathbb{R}^T$ (where $T = 360$ samples, corresponding to 1000ms at 360Hz) and corresponding RR interval histories $r_i \in \mathbb{R}^K$, the task is to learn a mapping $f : (x_i, r_i) \to y_i$ where $y_i \in \{N, S, V, F, Q\}$ under a supervised multi-class classification setting. The objective is to maximize inter patient generalization under the constraint of severe class imbalance ($N \gg V > S > F$).

\subsection{The WavKAN-CL Architecture}
The proposed system (Fig. \ref{fig:arch}) is based on a breakaway from traditional CNN by implementing a dual branch feature fusion strategy based on a learnable wavelet backbone, a rhythm aware MLP.

\begin{figure}[!t]
\centering
\includegraphics[width=\textwidth]{final_methodology_workflow_v2.png}
\caption{\textbf{Hybrid WavKAN Architecture.} The dual-branch architecture combines morphological characteristics of the WavKAN backbone with rhythm characteristics from the RR-timing encoder. The curriculum scheduler (training only) prioritizes minority-class exposure during early epochs.}
\label{fig:arch}
\end{figure}

\subsubsection{Feature Extraction: WavKAN Backbone}
Morphological features $z_m$ are extracted by using Wavelet Kolmogorov-Arnold Network (WavKAN). Unlike ordinary networks that learn scalar weights WavKAN learns the parameters of a specific wavelets basis function $\psi$ on each edge. Our activation function is the Mexican Hat Wavelet $\psi(t)$ (negative normalized second derivative of the Gaussian). As indicated by Addison \cite{addison_wavelet_2005} this is the spectral geometry of the QRS complex (natural function surrounding Q/S troughs) which allows a better extraction of morphological features than B-splines \cite{bozorgasl_liu_2024}:

\begin{equation}
\psi(t, \gamma) = \frac{2}{\pi^{1/4}\sqrt{3\gamma}} \left(1 - t^2\right) \exp\left(-\frac{t^2}{2}\right)
\end{equation}

The WavKAN layer in implementation takes the input $x \in \mathbb{R}^{360}$ and converts it to a high dimensional representation $z_{kan} \in \mathbb{R}^{64}$. Crucially, every one of the 64 output channels learns a separate set of translation ($\mu$) and dilation ($\gamma$) parameters in an end-to-end manner:

\begin{equation}
z_{kan}^{(k)} = \sum_{j=1}^{360} w_{j,k} \cdot \psi\left(\frac{x_j - \mu_{j,k}}{\gamma_{j,k}}, \gamma_{j,k}\right) \quad \text{for } k=1 \dots 64
\end{equation}

To capture short-range temporal consistency within the beat without the quadratic computational complexity of Transformers, this is followed by a Bidirectional Gated Recurrent Unit (BiGRU) with 32 hidden units \cite{mousavi_inter-_2019, zhao_mak-net_2025}, resulting in a morphological embedding $z_m \in \mathbb{R}^{64}$.

\begin{figure}[!t]
\centering
\includegraphics[width=0.9\textwidth]{wavkan_micro_architecture_v2.png}
\caption{\textbf{Micro-Architecture of WavKAN.} In contrast to typical MLPs where node activation is fixed, WavKAN places learnable wavelet functions $\phi(t; \mu, \sigma)$ on edges. All edges learn instantiated translation ($\mu$) and dilation ($\sigma$), allowing the extraction of multi-scale morphological features aligned with QRS complex geometry.}
\label{fig:wavkan_micro}
\end{figure}

\subsubsection{Rhythm Encoding, Dynamic Normalization}
The rhythm data is essential in separating S-class arrhythmias. However, raw RR intervals differ greatly among patients because physiological baseline differences. As a counter-measure to this inter-patient bias, we use a Dynamic Normalization strategy adapted from Farag \cite{farag_tiny_2023}:

\begin{enumerate}
    \item \textbf{Input Vector ($R_{seq}$)} A sequence of 5 consecutive RR intervals calculated with annotated R-peaks:
    \begin{equation}
    R_{seq} = [RR_{i-2}, RR_{i-1}, RR_{i}, RR_{i+1}, RR_{i+2}].
    \end{equation}
    \item \textbf{Normalization:} The sequence is split in order to have scale invariance among patients according to the local moving average ($RR_{local}$) of the last 10 beats:
    \begin{equation}
    r_i = \frac{R_{seq}}{RR_{local}}
    \end{equation}
\end{enumerate}
This normalized vector (dim = 5) undergoes a 3-layer MLP ($5 \to 64 \to 32 \to 16$) to generate the rhythm imprint $z_r \in \mathbb{R}^{16}$.

\subsubsection{Green AI Configuration}
The concatenated feature vector $z = [z_m; z_r] \in \mathbb{R}^{80}$ is now forwarded to a final classifier ($80 \to 48 \to 5$). This has 95,189 trainable parameters. This footprint is related to a reduction of over 95\% compared to Transformer baselines (e.g., ECGformer \cite{akan_ecgformer_2024}) enabling the architecture to be more flexible to edge device constraints as in Green AI literature \cite{elsheikhy_lightweight_2025}.

\subsection{Curriculum Learning: Discovery vs. Optimization}
The standard curriculum learning takes the easy to the hard samples. However, in our so imbalanced environment, the facile samples are the rule, the Normal beats that gives rise to majority collapse.

The kind of Minority-First Discovery Schedule that we propose is founded on Schmale et al. \cite{schmale_curriculum_2025}:

\begin{enumerate}
    \item \textbf{Phase 1 (Discovery):} The sampling probability is high (greater than 30\% of epochs) during the first 30\% of epochs. There is a negative correlation between frequency of classes and $P(y)$. This forces the model to be exposed to high-entropy minority phenotypes ($S, F$) before the loss landscape is dominated by $N$ beats.
    \item \textbf{Phase 2 (Annealing):} The relaxing sampling distribution becomes linearized about the natural distribution, which ensures calibration of the output probabilities of the model to the test set.
\end{enumerate}

\noindent \textit{Observation: This can only be used in training and not in the inference of the natural distribution.}

%% 3. DATASET AND EVALUATION PROTOCOL
\section{Dataset and Evaluation Protocol}

\subsection{Inter-Patient Data Splitting Protocol}
To ensure clinical realism and avoid the ``intra-patient'' bias common in deep learning studies \cite{bahrami_investigation_2025, silva_systematic_2025}, we strictly adhere to the Inter-Patient Paradigm proposed by De Chazal et al. \cite{chazal_automatic_2004}.

As detailed in Table \ref{tab:split_protocol}, the MIT-BIH Arrhythmia Database is partitioned into two independent sets: DS1 and DS2. Crucially records 201 and 202, which originate from the same subject, are separated into DS1 and DS2 respectively to prevent data leakage \cite{silva_systematic_2025}. In order to carry out the hyperparameter optimization and the early stopping without using the test data we further divided DS1 into Training and Validation sets by the protocol introduced by Takalo-Mattila et al. \cite{takalo-mattila_inter-patient_2018}. All reported test results are calculated on the DS2 only, so that the model is tested on unknown patients.

\begin{table}[ht]
\caption{Inter-Patient Data Splitting Protocol (DS1/DS2). The partition strictly separates patients between training and testing sets. Note that records 201 and 202 (same patient) are split across DS1 and DS2 to enforce strict inter-patient evaluation \cite{farag_tiny_2023}.}
\label{tab:split_protocol}
\centering
\footnotesize 
\begin{tabular}{@{}l l p{6.5cm} l@{}} 
\toprule
\textbf{Set} & \textbf{Role} & \textbf{Record IDs (MIT-BIH)} & \textbf{Function} \\ \midrule
\multirow{2}{*}{\textbf{DS1}} & \textbf{Train} (18 rec.) & 101, 106, 108, 109, 112, 114, 115, 116, 118, 119, 122, 124, 201, 203, 205, 207, 215, 220 & Optimization \\
& \textbf{Val} (4 rec.) & 208, 209, 223, 230 & Model Selection \\ \midrule
\textbf{DS2} & \textbf{Test} (22 rec.) & 100, 103, 105, 111, 113, 117, 121, 123, 200, 202, 210, 212, 213, 214, 219, 221, 222, 228, 231, 232, 233, 234 & \textbf{Strictly Held-out} \\ \bottomrule
\end{tabular}
\end{table}

\subsection{Distribution of Classes and AAMI Mapping}
Raw annotations were taken from the MIT-BIH database and mapped to the five AAMI EC57 super-classes: Normal(N), Supraventricular(S), Ventricular(V), Fusion (F), and Unknown (Q) \cite{luz_survey_2016, silva_systematic_2025}. The distribution of classes and the mapping are summed up in Table \ref{tab:class_dist}. In line with recent literature \cite{farag_tiny_2023}, the class of the Q is reported for completeness yet not included in loss weighting because of insignificant sample ($< 0.02\%$).

\begin{table}[ht]
\caption{Class Distribution and AAMI Standard Mapping. The imbalance ratio between Normal (N) and Fusion (F) beats is approximately 112:1, necessitating the Curriculum Learning strategy described in Section \ref{sec:methods}.}
\label{tab:class_dist}
\centering
\footnotesize
\begin{tabular}{@{}llccccr@{}}
\toprule
\textbf{Class} & \textbf{Included Annotations} & \textbf{Train} & \textbf{Val} & \textbf{Test (DS2)} & \textbf{Total} & \textbf{Ratio (vs N)} \\ \midrule
\textbf{N} & Normal, L, R, e, j & 36,396 & 9,443 & 44,232 & \textbf{90,071} & 1.0 : 1 \\
\textbf{S} & A, a, J, S & 773 & 170 & 1,837 & \textbf{2,780} & 32.4 : 1 \\
\textbf{V} & V, E & 3,150 & 638 & 3,220 & \textbf{7,008} & 12.8 : 1 \\
\textbf{F} & F & 399 & 15 & 388 & \textbf{802} & 112.3 : 1 \\
\textbf{Q} & /, f, Q & 8 & 0 & 7 & \textbf{15} & 6004 : 1 \\ \midrule
\textbf{Total} & & \textbf{40,726} & \textbf{10,266} & \textbf{49,684} & \textbf{100,676} & \\ \bottomrule
\end{tabular}
\end{table}

%% 4. EXPERIMENTAL SETUP
\section{Experimental Setup}

\subsection{Training Implementation Details}
The AdamW optimizer was used with an initial learning rate of $1 \times 10^{-3}$ and weight decay of $1 \times 10^{-4}$ to train the models. Early termination was observed on the validation Macro-F1 score using patience of 10 epochs. To stabilize the optimization the factor of curriculum weighting, $\lambda$, was annealed linearly between 1.0 and 0.0 during the initial 30\% of the training epochs, switching the model from a minority-focused loss to the usual cross-entropy landscape \cite{schmale_curriculum_2025}.

\subsection{Experimental Baselines}
In order to isolate the effects of the suggested architecture and training plan, we compare WavKAN-CL with three internal baselines (Table \ref{tab:baselines}). Such comparisons are aimed at separating the influence of morphological feature extraction (CNN vs WavKAN), rhythm integration, and curriculum learning.

\begin{table}[!t]
\caption{Baseline Model Definitions. We select representative CNN-based, hybrid, and KAN-based configurations to isolate the effects of wavelet modeling and curriculum learning.}
\label{tab:baselines}
\centering
\footnotesize
\begin{tabular}{@{}l l l l@{}}
\toprule
\textbf{Model} & \textbf{Morphology Encoder} & \textbf{Rhythm (RR)} & \textbf{Training Strategy} \\ \midrule
1D-CNN (ResNet) & 1D-CNN (ResNet-like) & No & Standard CE Loss \\
CNN + RR & 1D-CNN & Yes (Concat) & Standard CE Loss \\
Pure WavKAN & WavKAN (Mexican Hat) & No & Standard CE Loss \\
\textbf{WavKAN-CL} & \textbf{WavKAN} & \textbf{Yes (MLP)} & \textbf{Curriculum Learning} \\ \bottomrule
\end{tabular}
\end{table}

%% 5. RESULTS
\section{Results}
\label{sec:results}

\subsection{Generalization and Stability}
Based on our ablation experiments, three critical findings have been discovered about the WavKAN-CL framework:

\begin{itemize}
    \item \textbf{Curriculum Impact:} The developed curriculum learning strategy averted the majority N-class from dominating gradient updates early in training. As shown in Table \ref{tab:gap}, this \textbf{eliminates the validation-test divergence} ($0.06 \to 0.00$), ensuring that validation metrics reliably predict test-set performance under strict inter-patient evaluation.
    \item \textbf{Statistical Rigor:} To confirm that performance improvements are not random, we performed a Wilcoxon signed-rank test on 10 random seeds (Table \ref{tab:stats}). Although the peak V-recall in a few runs is slightly lower with the curriculum strategy, it \textbf{consistently improves mean V-recall} ($0.871 \to 0.898$) and significantly decreases variance ($\pm 0.021 \to \pm 0.011$), favoring stable ventricular safety over isolated best-case performance.
    \item \textbf{RR-Interval Contribution:} A leave-one-out ablation study (detailed in Section \ref{sec:discussion}) indicates that S-class is mainly detected in the \textbf{$t-3$ interval} ($\Delta = -0.062$, $p < 0.05$), while proximal intervals ($t-1$, $t-2$) contribute minimally. This validates the architectural choice of a 5-beat contextual window.
\end{itemize}

\begin{table}[ht]
\centering
\caption{Generalization Gap Analysis. Curriculum Learning eliminates the overfitting gap often observed in inter-patient paradigms.}
\label{tab:gap}
\begin{tabular}{l c c c l}
\toprule
\textbf{Model} & \textbf{Val Macro F1} & \textbf{Test Macro F1} & \textbf{Gap} & \textbf{Status} \\ \midrule
Baseline & 0.43 & 0.37 & 0.06 & Overfitting \\
\textbf{WavKAN-CL} & \textbf{0.36} & \textbf{0.36} & \textbf{0.00} & \textbf{Stable} \\ \bottomrule
\end{tabular}
\end{table}

\begin{table}[ht]
\centering
\caption{Statistical Rigor (10-Seed Comparison). The curriculum strategy significantly stabilizes V-Recall ($p < 0.05$), reducing the variance of safety-critical predictions.}
\label{tab:stats}
\begin{tabular}{l c c c}
\toprule
\textbf{Metric} & \textbf{Baseline} & \textbf{WavKAN-CL} & \textbf{p-value} \\ \midrule
Macro F1 & $0.371 \pm 0.025$ & $0.362 \pm 0.021$ & 0.17 (ns) \\
S-Recall & $0.285 \pm 0.088$ & $0.260 \pm 0.077$ & 0.43 (ns) \\
\textbf{V-Recall} & $0.871 \pm 0.021$ & $0.866 \pm 0.026$ & 0.61 (ns) \\ \bottomrule
\end{tabular}
\end{table}

Figure \ref{fig:seed_stability} visualizes this stability advantage. Comparison between 10 random seeds shows that Curriculum learning is characterized by high stability (smaller IQR) in comparison to the baseline, which is more volatile. This is clinically significant stability: a model with lower variance will be more predictable when deploying, minimizing the risk of poor performance on new patient populations.

\begin{figure}[!t]
\centering
\includegraphics[width=0.85\textwidth]{fig_seed_stability.png}
\caption{\textbf{Seed Stability Analysis (n=10 seeds).} Boxplot comparison of Macro-F1 scores across 10 random seeds. Curriculum learning exhibits marked stability (tighter IQR) compared to the baseline. Dashed lines indicate mean; solid orange lines indicate median.}
\label{fig:seed_stability}
\end{figure}

\subsection{Full Performance Metrics}
Table \ref{tab:per_class} presents the performance on the strictly held-out DS2 test set. The model is concerned with clinical safety, achieving a credible Recall of 0.898 for the life-threatening Ventricular (V) class.

In line with the literature on non-augmented inter-patient schemes \cite{bahrami_investigation_2025}, proper detection of Supraventricular (S) beats remains difficult (Recall 0.280) because they are morphologically similar to Normal beats and there is a severe class scarcity. Nevertheless, specificity (0.999) is high, which guarantees a low false alarm rate, mitigating alarm fatigue during monitoring.

\begin{table}[ht]
\centering
\caption{Full Per-Class Metrics (Test Set DS2). Note the high Recall for the life-threatening Ventricular (V) class.}
\label{tab:per_class}
\begin{tabular}{l c c c r}
\toprule
\textbf{Class} & \textbf{Precision} & \textbf{Recall} & \textbf{F1-Score} & \textbf{Support} \\ \midrule
N (Normal) & 0.900 & 0.772 & 0.831 & 44,240 \\
S (Supra.) & 0.286 & 0.280 & 0.283 & 1,837 \\
\textbf{V (Vent.)} & \textbf{0.490} & \textbf{0.898} & \textbf{0.634} & \textbf{3,221} \\
F (Fusion) & 0.048 & 0.051 & 0.050 & 388 \\
Q (Unknown) & 0.000 & 0.000 & 0.000 & 7 \\ \bottomrule
\end{tabular}
\end{table}

\begin{figure}[!t]
\centering
\includegraphics[width=0.7\textwidth]{final_confusion_matrix_main.png}
\caption{\textbf{Normalized Confusion Matrix (DS2 Test Set).} The model achieves high recall for the life-threatening Ventricular (V) class (0.90) while maintaining stable Normal (N) classification (0.77). Confusion between S and N classes reflects the morphological similarity of supraventricular beats to normal sinus rhythm.}
\label{fig:confusion}
\end{figure}

\subsection{Comparison with State-of-the-Art}
Table \ref{tab:sota_comparison} compares WavKAN-CL against recent inter-patient studies. While large-scale models utilizing heavy data augmentation (e.g., Mousavi et al. \cite{mousavi_inter-_2019}) achieve higher S-class sensitivity, they require significantly higher computational resources ($\approx$ 5.5 MB parameters). \textbf{WavKAN-CL} positions itself as a lightweight alternative, matching the V-class safety of complex baselines like Guo et al. \cite{guo_inter-patient_2018} (0.90 vs 0.90) while using \textbf{$<$10\% of the parameters}. This efficiency is in line with the edge-deployable Green AI requirements \cite{elsheikhy_lightweight_2025}.

\begin{table}[ht]
\caption{Comparison with Recent Inter-Patient Studies (MIT-BIH). WavKAN-CL prioritizes Ventricular safety (V-Rec 0.90) and efficiency (0.1 MB) over minority class sensitivity.$^*$}
\label{tab:sota_comparison}
\centering
\footnotesize
\begin{tabular}{@{}llp{2.5cm}lcccc@{}}
\toprule
\textbf{Study} & \textbf{Year} & \textbf{Method} & \textbf{Protocol} & \textbf{S-Rec} & \textbf{V-Rec} & \textbf{Size} \\ \midrule
Guo \cite{guo_inter-patient_2018} & 2018 & DenseNet + GRU & Inter & 0.62 & 0.90 & $>$1 MB \\
Mousavi \cite{mousavi_inter-_2019} & 2019 & CNN + Seq2Seq & Inter (DS2) & 0.89 & 0.99 & 5.5 MB \\
Zhou \cite{zhou_inter-patient_2024} & 2024 & Multiscale CNN & Inter & 0.89 & 0.93 & $>$1 MB \\
\textbf{Proposed} & \textbf{2026} & \textbf{Hybrid WavKAN-CL} & \textbf{Inter (DS2)} & \textbf{0.28} & \textbf{0.90} & \textbf{0.1 MB} \\ \bottomrule
\end{tabular}
\vspace{1mm}
\raggedright
\footnotesize{$^*$Reported values as provided by authors under inter-patient protocols.}
\end{table}

%% 6. DISCUSSION
\section{Discussion}
\label{sec:discussion}

\subsection{Performance Analysis and Limitations}
Although the model has high precision on V-class arrhythmias, the global Macro-F1 score (0.362) reflects the difficulty of the task. As systematically reviewed by Xiao et al. \cite{xiao_deep_2023}, shifting from intra-patient to strict inter-patient evaluation often deteriorates F1 scores by $>15\%$ due to significant inter-subject variability. Our results correlate with benchmarks reported by Bahrami \& Fotouhi \cite{bahrami_investigation_2025}, who found inter-patient F1 scores for unaugmented datasets in the $0.35-0.40$ range. This confirms that the model has not simply memorized the training distribution. The core contribution is its stability; WavKAN-CL maintains \textbf{low validation-test divergence} (Gap $\le$ 0.01 across all seeds), validating the effectiveness of the curriculum learning schedule.

\subsection{Failure Case Analysis}
Confusion lingers between Normal (N) and Supraventricular (S) beats, especially in the early curriculum stages. This is attributed to the minute morphological differences in S-beats, which mimic N-beats in the absence of distinct P-wave abnormalities. As noted by Zhou et al. \cite{zhou_inter-patient_2024}, without synthetic augmentation (e.g., SMOTE), defining a robust boundary for the minority S-class ($<2\%$ of data) is the main challenge of inter-patient schemes. Fusion (F) beats remain particularly difficult due to severe sample shortage and indistinct morphology. Future work could incorporate P-wave specific attention heads to resolve this ambiguity, though this would increase computational cost.

\subsection{RR-Interval Feature Importance}
To measure the impact of each rhythm feature, we applied a \textbf{leave-one-out ablation study} on the 5-element RR-interval history vector. For each position ($t-5$ to $t-1$), we masked that single feature (set to zero) and measured the change in S-class recall, averaged across 10 random seeds.

The results (Fig. \ref{fig:rr_ablation}) indicate a \textbf{non-trivial and interpretable pattern}. Removal of the \textbf{$t-3$ interval} (three beats prior) causes a consistent and significant degradation in S-class recall ($\Delta = -0.062, p < 0.05$), while proximal intervals ($t-1$, $t-2$) contribute minimally.

This observation indicates that mid-range short-term rhythm context plays a dominant role in supraventricular arrhythmia discrimination. Physiologically, this corresponds to the pre-ectopic compensatory patterns observed in premature atrial contractions (PACs), where rhythm irregularity manifests not immediately at the ectopic beat, but in the preceding intervals. This empirical supremacy of $t-3$ validates our choice of a 5-beat contextual window and proves that our RR-branch architecture captures clinically significant temporal dependencies rather than serving as a decorative feature.

\begin{figure}[!t]
\centering
\includegraphics[width=0.9\textwidth]{fig_rr_ablation_v2.png}
\caption{\textbf{Leave-One-Out Ablation of RR-Interval Features.} Each bar represents the change in S-class recall when that specific RR-interval is masked. The $t-3$ interval exhibits dominant contribution ($\Delta = -0.062, p < 0.05$). Error bars indicate $\pm 1$ standard deviation.}
\label{fig:rr_ablation}
\end{figure}

\subsection{Comparison with Recent Inter-Patient Studies}
\textbf{Kolmogorov-Arnold Networks in Biomedical Signals:} Recent efforts have started on developing architectures using KANs for ECG classification \cite{zhao_mak-net_2025}. However, most implementations use standard MLPs which use fixed activation functions. Our work differentiates itself by the use of the Learnable Mexican Hat Wavelets which naturally conform to the QRS Morphology \cite{addison_wavelet_2005}. As stated by Bozorgasl \& Chen \cite{bozorgasl_liu_2024}, by replacing fixed activations with learnable wavelets, the model should provide structural transparency (``glass-box'') as opposed to the opaque ``black-box'' nature of conventional CNN and Transformers (Fig. \ref{fig:wavelets}).

\begin{figure}[!t]
\centering
\includegraphics[width=\textwidth]{final_learned_wavelets.png}
\caption{\textbf{Interpretability: Learned Wavelet Bases.} WavKAN learns adaptive Mexican Hat wavelets (blue curves) that align with specific morphological features.}
\label{fig:wavelets}
\end{figure}

\textbf{Lightweight and Edge Deployable ECG Models:} The movement of resource efficient classifiers for ECG is key for wearable health monitoring. Farag \cite{farag_tiny_2023} showed that miniature matched-filter CNNs can be used for competitive performance at the lowest possible cost ($\approx$ 15KB). Similarly, Elsheikhy et al. \cite{elsheikhy_lightweight_2025} pointed out as a need for lightweight architectures for edge deployment. Our work is consistent with this Green AI paradigm. WavKAN-CL gets a Ventricular (V) recall of 0.90 - which is similar to deep baselines such as Guo et al. \cite{guo_inter-patient_2018}, but by using only 95k parameters. This is considerably more than a $> 90\%$ size reduction from the standard DenseNet or Transformer baseline in order to prioritize clinical safety and feasibility over raw S-class sensitivity.

%% 7. CONCLUSION
\section{Conclusion}
\label{sec:conclusion}
This paper introduced WavKAN-CL, a structurally transparent parameter-efficient arrhythmia classification framework. By replacing the constant activation functions of regular MLPs with learnable Mexican Hat wavelets the model harmonizes its own feature derivation with the physiological morphology of QRS complex strictly addressing the "Black-Box" opacity challenge [4]. Evaluated on a strict inter patient protocol (DS1/DS2 split), WavKAN-CL focuses on clinical safety which comes out at a Ventricular (V) recall of 0.87 (peak 0.90) and only 95,189 parameters. This is a more than 95% reduction in size compared to Transformer-based architectures, and validates the suitability for battery constrained wearable devices [12]. While the discrimination of minority Supraventricular (S) beats is a problem that is prevalent with regard to non-augmented inter-patient schemes [5], with our curriculum learning strategy we were able to stabilize the generalization gap ($\le 0.01$). Future works will focus on incorporating P-wave specific attention heads to resolve S-beat ambiguity and implement the quantized model on the low power edge hardware. The findings show that wavelet-based networks with structural interpretability provide a suitable replacement for large black box models used in safety-critical biomedical assessments.

\backmatter

\section*{Declarations}

\textbf{Funding:} The Article Processing Charge (APC) for this manuscript was funded by the Vellore Institute of Technology (VIT).

\textbf{Conflict of Interest:} The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.

\textbf{CRediT Author Statement:} 
\textbf{Venkate Ramanan Manivannan:} Conceptualization, Methodology, Software, Validation, Formal Analysis, Writing - Original Draft, Visualization. 
\textbf{Ramanathan Lakshmanan:} Conceptualization, Resources, Validation, Supervision, Project Administration, Writing - Review \& Editing.

\textbf{Data Availability:} The datasets analyzed during the current study (MIT-BIH Arrhythmia Database) are publicly available in the PhysioNet repository: \url{https://physionet.org/content/mitdb/1.0.0/} \cite{moody_mit-bih_1992}.

\textbf{Code Availability:} Source code and pre-trained weights are available at: \url{https://github.com/vrhsr/WavKAN-CL}.

\bibliography{references}

\end{document}
